from pdf2image import convert_from_path
import pytesseract
import cv2
import numpy as np

# Convert PDF to images
pdf_path = r"filepath.pdf"  # Confirm this path
poppler_path = r"filepath\bin"  # Confirmed path
images = convert_from_path(pdf_path, poppler_path=poppler_path)

# Process each page
for i, image in enumerate(images):
    # Convert to OpenCV format (minimal preprocessing)
    img = np.array(image)
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)  # Grayscale only, no thresholding

    # Extract text with PSM 1
    text_psm1 = pytesseract.image_to_string(gray, config="--psm 1")  # Automatic layout

    # Save PSM 1 output
    with open(f"page_{i + 1}_psm1.txt", "w", encoding="utf-8") as f1:
        f1.write(f"Page {i + 1} Content (PSM 1):\n{text_psm1}")
    print(f"Saved page {i + 1} to page_{i + 1}_psm1.txt")
